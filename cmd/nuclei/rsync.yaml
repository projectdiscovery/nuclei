id: rsync-list-shares

info:
  name: Rsync Basic Auth - Detect
  author: ciccio
  severity: info

javascript:
  - code: |
      const rsync = require('nuclei/rsync');
      const client = new rsync.RsyncClient();
      const moduleResponse = client.ListModules(Host, Port, Username, Password);
      log(to_json(moduleResponse));
      for (const module of moduleResponse.Modules) {
        const fileResponse = client.ListFilesInModule(Host, Port, Username, Password, module);
        log(to_json(fileResponse));
      }

    args:
      Host: "{{Host}}"
      Port: "873"
      Username: "{{Username}}"
      Password: "{{Password}}"

    matchers:
      - type: dsl
        dsl:
          - "success == true"